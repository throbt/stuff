/*
 * mnvc javascript framework, written by thRobt(robthot@gmail.com)
 * licensed under the terms of WFTPL (http://en.wikipedia.org/wiki/WTFPL)
 */
var DomBuilder=(function(){var b={};function f(j,m){var n=m||document.body,k=this,o=document.createElement(j.type);for(var l in j){switch(l){case"id":$(o).attr("id",j[l]);break;case"cls":$(o).addClass(j[l]);break;case"style":$(o).attr("style",j[l]);break;case"iType":$(o).attr("type",j[l]);break;case"arr":break;case"html":break;case"cmd":break;case"type":break;default:$(o).attr(l,j[l]);break}}n.appendChild(o);if(j.arr&&j.arr.length!==0){for(var h in j.arr){k.create(j.arr[h],o)}}if(j.html){$(o).html(j.html)}if(j.cmd){$(o).bind(j.cmd[0],j.cmd[1])}return o}function a(l,h){var j=this,m,n=$(h)[0];for(var k in l.childNodes){m=l.childNodes[k];if(m==n){l.removeChild(m);for(var o in j.cache){if(j.cache[o]==n){j.cache[o]=null;delete j.cache[o];return}}}}}function d(m,l,p,j,n){n=n||10;var h=this,o=m;if(typeof DomBuilder.getAttrib=="undefined"){DomBuilder.getAttrib=function(i,q){if(typeof q!="undefined"&&typeof i!="undefined"){return $(i).attr(q)}return null}}if(!l){return m.parentNode}for(var k=0;k<n;k++){if(o.tagName!="HTML"){if(typeof p=="undefined"&&l==o.tagName){return o}else{if(DomBuilder.getAttrib(o,p)!==null){if(DomBuilder.getAttrib(o,p).match(j)){return o}}}}else{return null}o=o.parentNode}return null}function e(h){var i=$(this).attr("class");if(typeof i!="undefined"&&i.match(h)){return true}else{return false}}function g(h){var i=$(this).attr("class");if(typeof i!="undefined"&&!i.match(h)){$(this).attr("class",[i," ",h].join(""))}}function c(j){var k=$(this).attr("class");if(typeof k!="undefined"&&k.match(j)){var h=k.split(j),i=[h[0]," ",h[1]].join("");$(this).attr("class",i)}}return{hasClassName:e,addClassName:g,removeClassName:c,cache:b,create:f,remove:a,getParent:d}})();var Stuff=(function(){var a=function(c){var d=[],f;for(var e=c.length-1,g=0;e>=g;--e){f=c[e];if($.inArray(f,d)==-1&&f.match(/[a-zA-Z0-9]/)){d.unshift(f)}}return d};var b=function(){var c=function(){var d=Math.ceil(Math.random()*256).toString(16);if(d.length==1){d+="0"}return d};return["#",c(),c(),c()].join("")};return{arrayUnique:a,getRndRGB:b}})();var Globals=(function(){function b(c,d){var c=c||0,d=d||0;if(c!==0&&d!==0){window[c]=d}}function a(c){var c=c||0;if(window[c]){return window[c]}}return{add:b,read:a}})();var Dispatcher=(function(){var c={};function a(d,f,e){c[d]=c[d]||[];c[d].push({fn:f,scope:e})}function b(d){if(!c[d]){return}for(var f=0;f<c[d].length;++f){var e=c[d][f];e.fn.apply(e.scope||this,Array.prototype.slice.call(arguments,1))}}return{on:a,fireEvent:b}})();var Effect=(function(){var a=function(b){if(b<(1/2.75)){return(7.5625*b*b)}else{if(b<(2/2.75)){return(7.5625*(b-=(1.5/2.75))*b+0.75)}else{if(b<(2.5/2.75)){return(7.5625*(b-=(2.25/2.75))*b+0.9375)}else{return(7.5625*(b-=(2.625/2.75))*b+0.984375)}}}};return{bounce:a}})();var Dragger=(function(){var h=false,g="",b={},f;var d=function(j){if(j.pageX||j.pageY){return{x:j.pageX,y:j.pageY}}return{x:j.clientX+document.body.scrollLeft-document.body.clientLeft,y:j.clientY+document.body.scrollTop-document.body.clientTop}};var e=function(j){j=j||window.event;Dragger.mousePos=d(j);if(typeof Dragger.callback=="function"){Dragger.callback(j)}};var a=function(j,m){Dragger.cfg=m||{};if(j.length>0){Dragger.selector=$(j[0]).attr("class");if(!h){$(document).mousemove(e);h=true}for(var n=0,k=j.length;n<k;++n){i(j[n]);$(j[n]).mouseover(function(l){if(Dragger.mouseover_hook){Dragger.mouseover_hook(this,l)}});$(j[n]).mouseout(function(l){if(Dragger.mouseout_hook){Dragger.mouseout_hook(this,l)}})}}};var i=function(l){var j=this,k=$(l).find(".anchor");$(k).mouseover(function(m){if(Dragger.anchor_mouseover_hook){Dragger.anchor_mouseover_hook(this,m)}});$(k).mouseover(function(m){if(Dragger.anchor_mouseout_hook){Dragger.anchor_mouseout_hook(this,m)}});$(k).mousedown(function(m){Dragger.el=$.getParent(this,"LI","class",Dragger.selector);if(!$(Dragger.el).hasClassName("dragged")){Dragger.leftDis=(Number(Dragger.mousePos.x)-parseInt($(Dragger.el).css("left"),10));Dragger.topDis=(Number(Dragger.mousePos.y)-parseInt($(Dragger.el).css("top"),10));$(Dragger.el).addClassName("dragged");Dragger.callback=Dragger.dragThis;if(Dragger.mousedown_hook){Dragger.mousedown_hook(Dragger.el,m)}}return false});$(k).mouseup(function(m){Dragger.callback="";$(Dragger.el).removeClassName("dragged");if(Dragger.mouseup_hook){Dragger.mouseup_hook(Dragger.el,m)}return false})};var c=function(){if(Dragger.mousemove_listener){Dragger.mousemove_listener(this)}if(Dragger.cfg.move){switch(Dragger.cfg.move){case"vertical":$(Dragger.el).css({top:Dragger.mousePos.y-Dragger.topDis});break;case"horizontal":$(Dragger.el).css({left:Dragger.mousePos.x-Dragger.leftDis});break;case"both":$(Dragger.el).css({top:Dragger.mousePos.y-Dragger.topDis,left:Dragger.mousePos.x-Dragger.leftDis});break}}else{$(Dragger.el).css({top:Dragger.mousePos.y-Dragger.topDis,left:Dragger.mousePos.x-Dragger.leftDis})}};return{selector:"",cfg:b,callback:g,dragThis:c,drag:function(j){a(this,j)}}})();var Component=(function(){var b=function(f,d){if(typeof f=="function"){for(var e in d){f.prototype[e]=d[e]}}else{if(typeof f=="object"&&typeof d=="object"){for(var c in d){f[c]=d[c]}}}};function a(e,c){var f=function(){return c._construct.call(this,arguments)};f.prototype=new e();for(var d in c){if(d!="_construct"){f.prototype[d]=c[d]}}return f}return{merge:b,extend:a}})();var _construct=function(a){this.cfg=a||{}};var Form=Component.extend(_construct,{build:function(){this.reference=$.create({type:"div",cls:this.cls},this.parent);this.body=$.create({type:"form",action:this.action,method:this.method,enctype:(this.multipart?"multipart/form-data":""),id:this.id},this.reference)},_construct:function(a){this.cfg=a[0]||{};this.id=(this.cfg.id?this.cfg.id:"");this.method=(this.cfg.method?this.cfg.method:"");this.action=(this.cfg.action?this.cfg.action:"");this.parent=(this.cfg.parent?this.cfg.parent:"");this.cls=(this.cfg.cls?this.cfg.cls:"");this.multipart=(this.cfg.multipart?this.cfg.multipart:false);this.build()}});var Fieldset=Component.extend(_construct,{build:function(){this.body=$.create({type:"fieldset",cls:this.cls,id:[this.id,"_fieldset"].join(""),arr:[{type:"legend",html:this.legend,cls:this.legendCls}]},this.parent)},_construct:function(a){this.cfg=a[0]||{};this.id=(this.cfg.id?this.cfg.id:"");this.parent=(this.cfg.parent?this.cfg.parent:"");this.cls=(this.cfg.cls?this.cfg.cls:"");this.legend=(this.cfg.legend?this.cfg.legend:"");this.legendCls=(this.cfg.legendCls?this.cfg.legendCls:"");this.build()}});var FormEl=Component.extend(_construct,{wrapper:function(){this.parent=(this.cfg.parent?this.cfg.parent:"");this.label=(this.cfg.label?this.cfg.label:"");this.id=(this.cfg.id?this.cfg.id:"");this.value=(this.cfg.value?this.cfg.value:"");this.reference=$.create({type:"div",cls:"control-group",arr:[{type:"label","for":[this.id,"_input"].join(""),id:[this.id,"_label"].join(""),cls:"control-label",html:this.label},{type:"div",id:(this.id!==""?[this.id,"_wrap"].join(""):""),cls:"controls"}]},this.parent)},setValue:function(a){this.value=a||"";switch(this.type){case"textarea":$(["#",this.id,"_input"].join("")).html(this.value);break;case"select":if(typeof this.value=="number"){$(["#",this.id,"_input"].join("")).val(this.options[this.value])}else{$(["#",this.id,"_input"].join("")).val(this.value)}break;default:$(["#",this.id,"_input"].join("")).val(this.value);break}},getValue:function(){return(this.value?this.value:null)},setLabel:function(a){this.label=a||"";$(["#",this.id,"_label"].join("")).html(this.label)},getLabel:function(){return(this.label?this.label:null)},_construct:function(a){this.cfg=a[0]||{}}});var Text=Component.extend(FormEl,{type:"text",build:function(){var a={type:"input",iType:"text",cls:"input  input-xlarge",id:[this.id,"_input"].join(""),name:[this.id,"_input"].join("")};if(this.disabled){a.disabled="disabled"}$.create(a,$(["#",this.id,"_wrap"].join(""))[0])},setup:function(){var a=this;$(["#",this.id,"_input"].join("")).keyup(function(){a.setValue($(this).val());a.change(a)})},_construct:function(a){this.cfg=a[0]||{};if(this.cfg.id&&this.cfg.parent&&this.cfg.label){this.disabled=(this.cfg.disabled?this.cfg.disabled:false);this.change=(this.cfg.change?this.cfg.change:function(){});this.wrapper();this.build();this.setup();if(this.cfg.value!==""){this.setValue(this.cfg.value)}}}});var Password=Component.extend(FormEl,{type:"password",build:function(){var a={type:"input",iType:"password",cls:"input  input-xlarge",id:[this.id,"_input"].join(""),name:[this.id,"_input"].join("")};if(this.disabled){a.disabled="disabled"}$.create(a,$(["#",this.id,"_wrap"].join(""))[0])},setup:function(){var a=this;$(["#",this.id,"_input"].join("")).keyup(function(){a.setValue($(this).val());a.change(a)})},_construct:function(a){this.cfg=a[0]||{};if(this.cfg.id&&this.cfg.parent&&this.cfg.label){this.change=(this.cfg.change?this.cfg.change:function(){});this.disabled=(this.cfg.disabled?this.cfg.disabled:false);this.wrapper();this.build();this.setup();if(this.cfg.value!==""){this.setValue(this.cfg.value)}}}});var Textarea=Component.extend(FormEl,{type:"textarea",build:function(){$.create({type:"textarea",cls:"input  input-xlarge",id:[this.id,"_input"].join(""),name:[this.id,"_input"].join("")},$(["#",this.id,"_wrap"].join(""))[0])},setup:function(){var a=this;$(["#",this.id,"_input"].join("")).keyup(function(){a.setValue($(this).val());a.change(a)})},_construct:function(a){this.cfg=a[0]||{};if(this.cfg.id&&this.cfg.parent&&this.cfg.label){this.change=(this.cfg.change?this.cfg.change:function(){});this.wrapper();this.build();this.setup();if(this.cfg.value!==""){this.setValue(this.cfg.value)}}}});var Checkbox=Component.extend(FormEl,{type:"checkbox",wrapper:function(){this.parent=(this.cfg.parent?this.cfg.parent:"");this.label=(this.cfg.label?this.cfg.label:"");this.id=(this.cfg.id?this.cfg.id:"");this.value=(this.cfg.value?this.cfg.value:"");this.reference=$.create({type:"div",cls:"control-group",arr:[{type:"div",id:(this.id!==""?[this.id,"_wrap"].join(""):""),cls:"controls",arr:[{type:"label","for":[this.id,"_input"].join(""),id:[this.id,"_label"].join(""),cls:"checkbox",html:this.label}]}]},this.parent)},build:function(){var a={type:"input",iType:"checkbox",cls:"input  input-xlarge",id:[this.id,"_input"].join(""),name:[this.id,"_input"].join(""),value:this.value};if(this.disabled){a.disabled="disabled"}this.body=$.create(a,$(["#",this.id,"_label"].join(""))[0])},check:function(){$(["#",this.id,"_input"].join("")).attr("checked","checked")},isChecked:function(){return $(["#",this.id,"_input"].join("")).is(":checked")},setLabel:function(a){this.label=a||"";$(["#",this.id,"_label"].join("")).html(this.label);this.build();this.setup()},getLabel:function(){return(this.label?this.label:null)},setup:function(){var a=this;$(["#",this.id,"_input"].join("")).click(function(){a.change(a)})},_construct:function(a){this.cfg=a[0]||{};this.change=(this.cfg.change?this.cfg.change:function(){});if(this.cfg.id&&this.cfg.parent&&this.cfg.label){this.disabled=(this.cfg.disabled?this.cfg.disabled:false);this.wrapper();this.build();this.setup();if(this.cfg.checked){this.check()}}}});var Select=Component.extend(FormEl,{type:"select",build:function(){var a={type:"select",cls:"input  input-xlarge",id:[this.id,"_input"].join(""),name:[this.id,"_input"].join("")};if(this.disabled){a.disabled="disabled"}this.body=$.create(a,$(["#",this.id,"_wrap"].join(""))[0])},setOptions:function(){var b=this.options,d="";for(var c=0,a=b.length;c<a;++c){d=b[c];$.create({type:"option",value:d,html:d},$(["#",this.id,"_input"].join(""))[0])}},addOption:function(a){this.options.push(a);this.removeOptions();this.setOptions()},addOptions:function(a){this.options=$.arrayUnique(a);this.removeOptions();this.setOptions()},deleteOption:function(c){var a,b=this;if(typeof c=="number"){c=this.options[c]}$(["#",this.id,"_input > option"].join("")).each(function(){if($(this).val()==c){$(this).remove();b.options.splice(a,1)}a++})},removeOptions:function(){$(["#",this.id,"_input > option"].join("")).each(function(){$(this).remove()})},setup:function(){var a=this;$(this.body).change(function(){a.setValue($(this).val());a.change(a)})},_construct:function(a){this.cfg=a[0]||{};this.selected=(this.cfg.selected?this.cfg.selected:this.options[0]);this.change=(this.cfg.change?this.cfg.change:function(){});this.disabled=(this.cfg.disabled?this.cfg.disabled:false);if(this.cfg.id&&this.cfg.parent&&this.cfg.label){this.wrapper();this.build();this.options=(this.cfg.options?this.cfg.options:[]);this.setOptions()}if(this.selected){this.setValue(this.selected)}this.setup()}});var Button=Component.extend(FormEl,{type:"button",wrapper:function(){this.parent=(this.cfg.parent?this.cfg.parent:"");this.label=(this.cfg.label?this.cfg.label:"");this.id=(this.cfg.id?this.cfg.id:"");this.reference=$.create({type:"div",cls:"control-group",arr:[{type:"div",id:(this.id!==""?[this.id,"_wrap"].join(""):""),cls:"controls"}]},this.parent)},build:function(){var a={type:(this.href&&this.href!=""?"a":"button"),cls:this.cls,id:[this.id,"_input"].join(""),name:[this.id,"_input"].join(""),html:this.label};if(this.target!=""){a.target=this.target}if(this.href&&this.href!=""){a.href=this.href}this.body=$.create(a,$(["#",this.id,"_wrap"].join(""))[0])},setup:function(){var a=this;$(this.body).click(function(){a.pressed(a);return false})},_construct:function(a){this.cfg=a[0]||{};this.pressed=(this.cfg.pressed?this.cfg.pressed:function(){});this.href=(this.cfg.href?this.cfg.href:"");this.cls=(this.cfg.cls?this.cfg.cls:"");this.label=(this.cfg.label?this.cfg.label:"");this.target=(this.cfg.target?this.cfg.target:"");this.wrapper();this.build();this.setup()}});var MultipleNumber=Component.extend(FormEl,{type:"custominput",getValue:function(){var b="";for(var a in this.value){b+=" "+this.value[a]}return b.substring(1,b.length)},setValue:function(a,b){var a=a||"",b=b||"";if(a!=""&&b!=""){if(this.value[a]){this.value[a]=b;$(["#",a].join("")).val(b)}}},build:function(){var g={},h={},f={},e={};this.value={};for(var d=0,c=this.elements.length;d<c;d++){g=this.elements[d];h={};switch(g.type){case"text":h={type:"input",iType:"text",cls:["input input-xlarge pull-left multiple ",(g.len?g.len:"")," ",this.id].join(""),id:[this.id,"_input_",d].join(""),value:(g.value?g.value:""),name:[this.id,"_input_",d].join("")};if(g.disabled){h.disabled="disabled"}$.create(h,$(["#",this.id,"_wrap"].join(""))[0]);this.value[[this.id,"_input_",d].join("")]=(g.value?g.value:"");break;case"select":$.create({type:"select",cls:["input input-xlarge pull-left multiple ",(g.len?g.len:"")," ",this.id].join(""),id:[this.id,"_input_",d].join(""),name:[this.id,"_input_",d].join("")},$(["#",this.id,"_wrap"].join(""))[0]);for(var b=0,a=g.options.length;b<a;b++){f=g.options[b];e={type:"option",value:f,html:f};if(b==g.selected){e.selected="selected"}$.create(e,$(["#",this.id,"_input_",d].join(""))[0])}this.value[[this.id,"_input_",d].join("")]=(g.selected?g.options[g.selected]:g.options[0]);break}}},setup:function(){var a=this;$([".",this.id].join("")).change(function(){a.setValue($(this).attr("id"),$(this).val());a.change(a)})},_construct:function(a){this.cfg=a[0]||{};this.id=(this.cfg.id?this.cfg.id:"");this.label=(this.cfg.label?this.cfg.label:"");this.change=(this.cfg.change?this.cfg.change:function(){});this.elements=(this.cfg.elements?this.cfg.elements:[]);this.value={};this.wrapper();this.build();this.setup()}});var Radio=Component.extend(FormEl,{type:"radio",wrapper:function(){this.parent=(this.cfg.parent?this.cfg.parent:"");this.label=(this.cfg.label?this.cfg.label:"");this.id=(this.cfg.id?this.cfg.id:"");this.value=(this.cfg.value?this.cfg.value:"");this.listener_class=[this.id,"_r_listener"].join("");this.reference=$.create({type:"div",cls:"control-group",id:(this.id!==""?[this.id,"_wrap"].join(""):""),arr:[{type:"label",id:[this.id,"_radio_label"].join(""),cls:"control-label",html:this.label},{type:"div",cls:"controls",id:[this.id,"_radio_wrapper"].join("")}]},this.parent)},build:function(){var b=this.options,d="";for(var c=0,a=b.length;c<a;++c){d=b[c];$.create({type:"label",id:[c,"_radio_label_",this.id].join(""),"for":[c,"_input_",this.id].join(""),cls:"radio",html:d},$(["#",this.id,"_radio_wrapper"].join(""))[0]);$.create({type:"input",iType:"radio",cls:["input  input-xlarge ",this.listener_class].join(""),id:[c,"_input_",this.id].join(""),name:[this.id,"_name"].join(""),value:d},$(["#",c,"_radio_label_",this.id].join(""))[0])}},setValue:function(a){var b="";if(typeof a=="number"){b=this.options[a]}else{b=a}$([".",this.listener_class].join("")).each(function(){if($(this).val()==b){$(this).attr("checked","checked")}});this.value=b},addOption:function(a){this.removeOptions();this.options.push(a);this.build();this.setup()},addOptions:function(a){this.options=$.arrayUnique(a);if(this.options.length===0){this.removeOptions()}else{this.removeOptions();this.build();this.setup()}},removeOptions:function(){$(["#",this.id,"_radio_wrapper > label"].join("")).each(function(){$(this).children().unbind();$(this).remove()})},deleteOption:function(c){var a,b=this;if(typeof c=="number"){c=this.options[c]}$(["#",this.id,"_radio_wrapper > label"].join("")).each(function(){if($(this).children().val()==c){$(this).children().unbind();$(this).remove();b.options.splice(a,1)}a++})},setup:function(){var a=this;$([".",this.listener_class].join("")).click(function(){a.setValue($(this).val());a.change(a)})},_construct:function(a){this.cfg=a[0]||{};this.change=(this.cfg.change?this.cfg.change:function(){});this.options=(this.cfg.options?this.cfg.options:[]);this.selected=(this.cfg.selected?this.cfg.selected:this.options[0]);if(this.cfg.id&&this.cfg.parent&&this.cfg.label){this.wrapper();this.build();this.setup()}if(this.selected){this.setValue(this.selected)}}});var RadioMatrix=Component.extend(FormEl,{type:"radiomatrix",getValue:function(){var j=this,k="",b="",e="",a={};for(var f=0,d=this.rows.length;f<d;++f){k=this.rows[f];a[k]="";for(var h=0,g=this.columns.length;h<g;++h){b=this.columns[h];e=["#",f,"_input_",j.id,"_",h].join("");if($(e).is(":checked")){a[k]=b}}}this.values=a;return this.values},addRows:function(a){this.values={};this.rows=$.arrayUnique(a);this.cleanUp();this.build();this.setup()},addColumns:function(a){this.values={};this.columns=$.arrayUnique(a);this.cleanUp();this.build();this.setup()},wrapper:function(){this.parent=(this.cfg.parent?this.cfg.parent:"");this.label=(this.cfg.label?this.cfg.label:"");this.id=(this.cfg.id?this.cfg.id:"");this.value=(this.cfg.value?this.cfg.value:"");this.reference=$.create({type:"div",cls:"control-group",id:[this.id,"_group"].join("")},this.parent)},build:function(){$.create({type:"table",cls:this.cls,id:[this.id,"_table"].join("")},$(["#",this.id,"_group"].join(""))[0]);var c="";$.create({type:"tr",id:["tr_head"].join(""),arr:this.getTableHead(),cls:"tr_head"},$(["#",this.id,"_table"].join(""))[0]);for(var b=0,a=this.rows.length;b<a;++b){c=this.rows[b];$.create({type:"tr",id:["tr_",b].join(""),arr:this.buildRow(b,c)},$(["#",this.id,"_table"].join(""))[0])}},getTableHead:function(){var d="",b=[];b.push({type:"td",id:["td_head_",c].join(""),cls:"td_label",html:""});for(var c=0,a=this.columns.length;c<a;++c){d=this.columns[c];b.push({type:"td",id:["td_head_",c].join(""),arr:[{type:"span",cls:"head_label",html:d}]})}return b},buildRow:function(c,f){var e="",b=[];b.push({type:"td",id:["td_",c,"_label"].join(""),cls:"td_label",arr:[{type:"label",cls:"control-label",arr:[{type:"span",cls:"head_label",html:f}]}]});for(var d=0,a=this.columns.length;d<a;++d){e=this.columns[d];b.push({type:"td",cls:"cell",id:["td_",c,"_",d].join(""),arr:[{type:"input",iType:"radio",rel:[c,"|",d].join(""),id:[c,"_input_",this.id,"_",d].join(""),cls:["input input-xlarge ",this.id,"_r_listener"].join(""),name:[this.id,"_name_",c].join(""),value:e}]})}return b},cleanUp:function(){$(["#",this.id,"_table"].join("")).remove()},setup:function(){var a=this;$([".",this.id,"_r_listener"].join("")).unbind();$([".",this.id,"_r_listener"].join("")).click(function(){a.change(a)})},_construct:function(a){this.cfg=a[0]||{};this.change=(this.cfg.change?this.cfg.change:function(){});this.columns=(this.cfg.columns?this.cfg.columns:[]);this.rows=(this.cfg.rows?this.cfg.rows:[]);this.cls=(this.cfg.cls?this.cfg.cls:"");this.values={};this.wrapper();this.build();this.setup()}});var CheckboxMatrix=Component.extend(FormEl,{type:"radiomatrix",getValue:function(){var j=this,k="",b="",e="",a={};for(var f=0,d=this.rows.length;f<d;++f){k=this.rows[f];a[k]=[];for(var h=0,g=this.columns.length;h<g;++h){b=this.columns[h];e=["#",f,"_input_",j.id,"_",h].join("");if($(e).is(":checked")){a[k].push(b)}}}this.values=a;return this.values},addRows:function(a){this.values={};this.rows=$.arrayUnique(a);this.cleanUp();this.build();this.setup()},addColumns:function(a){this.values={};this.columns=$.arrayUnique(a);this.cleanUp();this.build();this.setup()},wrapper:function(){this.parent=(this.cfg.parent?this.cfg.parent:"");this.label=(this.cfg.label?this.cfg.label:"");this.id=(this.cfg.id?this.cfg.id:"");this.value=(this.cfg.value?this.cfg.value:"");this.reference=$.create({type:"div",cls:"control-group",id:[this.id,"_group"].join("")},this.parent)},build:function(){$.create({type:"table",cls:this.cls,id:[this.id,"_table"].join("")},$(["#",this.id,"_group"].join(""))[0]);var c="";$.create({type:"tr",id:["tr_head"].join(""),arr:this.getTableHead(),cls:"tr_head"},$(["#",this.id,"_table"].join(""))[0]);for(var b=0,a=this.rows.length;b<a;++b){c=this.rows[b];$.create({type:"tr",id:["tr_",b].join(""),arr:this.buildRow(b,c)},$(["#",this.id,"_table"].join(""))[0])}},getTableHead:function(){var d="",b=[];b.push({type:"td",id:["td_head_",c].join(""),cls:"td_label",html:""});for(var c=0,a=this.columns.length;c<a;++c){d=this.columns[c];b.push({type:"td",id:["td_head_",c].join(""),arr:[{type:"span",cls:"head_label",html:d}]})}return b},buildRow:function(c,f){var e="",b=[];b.push({type:"td",id:["td_",c,"_label"].join(""),cls:"td_label",arr:[{type:"label",cls:"control-label",arr:[{type:"span",cls:"head_label",html:f}]}]});for(var d=0,a=this.columns.length;d<a;++d){e=this.columns[d];b.push({type:"td",cls:"cell",id:["td_",c,"_",d].join(""),arr:[{type:"input",iType:"checkbox",rel:[c,"|",d].join(""),id:[c,"_input_",this.id,"_",d].join(""),cls:["input input-xlarge ",this.id,"_r_listener"].join(""),name:[c,"_name_",this.id,"_",d].join(""),value:e}]})}return b},cleanUp:function(){$(["#",this.id,"_table"].join("")).remove()},setup:function(){var a=this;$([".",this.id,"_r_listener"].join("")).unbind();$([".",this.id,"_r_listener"].join("")).click(function(){a.change(a)})},_construct:function(a){this.cfg=a[0]||{};this.change=(this.cfg.change?this.cfg.change:function(){});this.columns=(this.cfg.columns?this.cfg.columns:[]);this.rows=(this.cfg.rows?this.cfg.rows:[]);this.cls=(this.cfg.cls?this.cfg.cls:"");this.values={};this.wrapper();this.build();this.setup()}});var Grid=(function(){var o=function(s){if(s.length>1){c(s);l()}};var g=function(s){this.cfg=s||{}};var j=[],n="",h="",p="",i="",a=0,b=10,m;var e=function(){var s=0,u={},t=0;$(".gridEl").each(function(){$(this).css({top:[s,"px"].join("")});s+=$(this).height()})};var c=function(y){var t,v=[],s=$(y[0]).parent(),z;for(var x=0,u=y.length;x<u;++x){v.push(y[x]);$(y[x]).remove()}this.body=$.create({type:"ul",id:"gridWrapper",cls:"gridWrapper"},$(s)[0]);Grid.elCounter=v.length;var w;for(var B=0,A=v.length;B<A;++B){z=(B===0?0:($(["#draggable_",B-1].join("")).height()+parseInt($(["#draggable_",B-1].join("")).css("top"),10)));w=new GridElement({top:z,id:["draggable_",B].join(""),data:B,rel:B,display:"block",parent:this.body,content:v[B]});Grid.elements.push(w)}Grid.frame=new EmptyFrame({top:$(["#draggable_",B-1].join("")).height()+parseInt($(["#draggable_",B-1].join("")).css("top"),10),id:"empty_frame",data:-1,rel:-1,display:"none",state:"hidden",parent:this.body,content:""});$(".draggable").draggable({move:"both"})};var r=function(s){return Grid.elements[$(s).attr("rel")]};var d=function(){var s=[];$(".gridEl").each(function(){if($(this).attr("id")!="empty_frame"){s.push(Grid.identity(this).getData())}});return s};var q=function(){var s,v,t,u="";$(".gridEl").each(function(){if($(this).attr("id")!="empty_frame"){s=$(this).attr("data");v=$(this).attr("rel");u+="order:  ,"+s+",  orig:  ,"+v+"\n "}});debText.setValue(u)};var f=function(){var w=[],u=[],y=[],x,z,t={};$(".gridEl").each(function(){if($(this).attr("id")!="empty_frame"){x=Grid.identity(this);z=(x==Grid.dragged?parseInt($(Grid.dragged.body).css("top"),10):parseInt(x.getTop(),10));w.push(z);u.push(z);y.push(x)}});u.sort(function(B,A){return(B-A)});debText2.setValue(w+" \n "+u);for(var v=0,s=u.length;v<s;++v){y[v].setData($.inArray(u[v],w))}w=null;u=null;y=null;x=null;z=null};var k=function(){$(".sensor").css("z-index","12000");$(Grid.dragged.sensor).css("z-index","100");$(Grid.touched.sensor).css("z-index","100");Grid.touched.overlapped()};var l=function(){$(".sensor").mouseover(function(s){if(Grid.action=="mousedown"){Grid.touched=Grid.identity(this);Grid.touched.touched();Grid.reSort();Grid.setLayout()}});$(".touched").live("mouseout",function(){Grid.identity(this).detouched()});Dragger.mousedown_hook=function(t,s){Grid.action="mousedown";Grid.dragged=Grid.identity(t);Grid.leftPos=Grid.dragged.getLeft();Grid.topPos=Grid.dragged.getTop();$(".sensor").css("z-index","12000");$(Grid.dragged.sensor).css("z-index","100");Grid.dragged.dragStarted()};Dragger.mouseup_hook=function(t,s){Grid.action="mouseup";$(".sensor").css("z-index","100");Grid.dragged.dragStopped()}};return{getOrder:d,debugOrder:q,leftPos:m,duration:b,reSort:f,elCounter:a,identity:r,dragged:h,touched:p,frame:i,setLayout:k,elements:j,_construct:g,action:n,rerender:e,init:function(){return o(this)}}})();var GridElement=Component.extend(Grid._construct,{build:function(){var a=$.getRndRGB();this.body=$.create({type:"li",id:this.id,style:["top:",this.top,"px;left:0px;background:",a,";display:",this.display].join(""),data:this.data,rel:this.data,cls:"draggable gridEl"},this.parent);$(this.body).append(this.content);var c=this.getWidth()+20,b=this.getHeight();this.sensor=$.create({type:"li",id:["sensor_",this.data].join(""),style:["top:",this.top,"px;left:0px;width:",c,"px;background:",a,";height:",b,"px;"].join(""),data:this.data,rel:this.data,cls:"draggable sensor"},this.parent)},touched:function(){$(this.sensor).addClassName("touched")},detouched:function(){$(this.sensor).css("z-index","12000");$(this.sensor).removeClassName("touched")},getTop:function(){var a=parseInt($(this.body).css("top"),10);this.setTop(a);return this.top},setTop:function(a){if(a!==null&&typeof a!="undefined"){this.top=a}},getLeft:function(){var a=parseInt($(this.body).css("left"),10);this.setLeft(a);return this.left},setLeft:function(a){if(a!==null&&typeof a!="undefined"){this.left=a}},getHeight:function(){return $(this.body).height()},setHeight:function(a){if(a!==null&&typeof a!="undefined"){this.height=a}},getData:function(){return $(this.body).attr("data")},setData:function(a){if(a!==null&&typeof a!="undefined"){this.data=a;$(this.body).attr("data",this.data);$(this.sensor).attr("data",this.data)}},getWidth:function(){return parseInt($(this.body).css("width"),10)},setWidth:function(a){if(typeof a=="number"){$(this.body).css("width",a)}},gravity:function(d,a,c){var b=this,d=(d=="auto"?0:d),a=(a=="auto"?0:a);b.top=d;b.callback=c||(typeof c=="function"?function(){c(b)}:function(){});emile(this.body,["top:",d,"px;left:",a,"px;"].join(""),{duration:Grid.duration,after:function(){$(b.sensor).css("top",b.getTop());$(b.sensor).css("left",b.getLeft());if(typeof c=="function"){b.callback(b)}}})},overlapped:function(){var g=Grid.dragged,a=Grid.touched,c=a.getTop(),d=g.getTop(),f=a.getData(),j=g.getData(),i=g.getHeight(),h=a.getHeight(),b=a.getWidth(),e=Grid.leftPos;console.log("touchedTop:  "+c,"draggedTop:  "+d);$(".sensor").css("z-index","12000");$(Grid.dragged.sensor).css("z-index","100");$(Grid.touched.sensor).css("z-index","100");Grid.debugOrder();if(c<d){thisDebugger.setValue("felfele : dragged: "+d+" , touched: "+c);this.gravity(this.getTop()+i,e,function(){Grid.frame.on(c,e,i,b,function(k){Grid.reSort()})})}else{if(c>d){thisDebugger.setValue("lefele : dragged: "+d+" , touched: "+c);this.gravity(Grid.frame.getTop(),e,function(){Grid.frame.on(c+(h-i),e,i,b,function(k){Grid.reSort()})})}}},dragStarted:function(){var c=this.getTop(),d=this.getLeft(),b=this.getHeight(),a=this.getWidth();Grid.frame.on(c,d,b,a,function(e){})},dragStopped:function(){this.gravity(Grid.frame.getTop(),Grid.leftPos,function(){Grid.reSort();Grid.frame.off()})},_construct:function(a){this.cfg=a[0]||{};this.top=(this.cfg.top?this.cfg.top:0);this.id=(this.cfg.id?this.cfg.id:"");this.data=(this.cfg.data?this.cfg.data:0);this.rel=(this.cfg.rel?this.cfg.rel:0);this.display=(this.cfg.display?this.cfg.display:"none");this.content=(this.cfg.content?this.cfg.content:{});this.parent=(this.cfg.parent?this.cfg.parent:"");this.build();this.setHeight(parseInt($(this.body).height(),10))}});var EmptyFrame=Component.extend(Grid._construct,{build:function(){this.body=$.create({type:"li",id:this.id,style:["top:",this.top,"px;left:0px;display:",this.display].join(""),data:this.data,cls:"draggable gridEl"},this.parent);$(this.body).append(this.content)},getTop:function(){var a=parseInt($(this.body).css("top"),10);this.setTop(a);return this.top},setTop:function(a){if(a!==null&&typeof a!="undefined"){this.top=a}},getLeft:function(){var a=parseInt($(this.body).css("left"),10);this.setLeft(a);return this.left},setLeft:function(a){if(a!==null&&typeof a!="undefined"){this.left=a}},getState:function(){return this.state},setState:function(a){if(a!==null&&typeof a!="undefined"){this.state=a;switch(this.state){case"hidden":this.display="none";$(this.body).css("display","none");break;case"visible":this.display="block";$(this.body).css("display","block");break}}},getHeight:function(){var a=parseInt($(this.body).height(),10);this.setHeight(a);return this.height},setHeight:function(a){if(a!==null&&typeof a!="undefined"){this.height=a}},getData:function(){this.data=$(this.body).attr("data");return this.data},setData:function(a){if(a!==null&&typeof a!="undefined"){this.data=a;$(this.body).attr("data",this.data)}},on:function(e,b,a,c,d){this.setState("visible");this.gravity(e,b,a,c,d)},off:function(){this.setState("hidden")},getWidth:function(){return parseInt($(this.body).css("width"),10)},setWidth:function(a){if(typeof a=="number"){$(this.body).css("width",a)}},getRel:function(){return parseInt($(this.body).attr("rel"),10)},setRel:function(a){if(typeof a=="number"){$(this.body).attr("rel",a)}},gravity:function(f,b,a,d,e){var c=this,f=(f=="auto"?0:f),b=(b=="auto"?0:b),a=(a=="auto"?0:a),d=(d=="auto"?0:d);c.top=f;c.callback=e||(typeof e=="function"?function(){e(c)}:function(){});emile(this.body,["top: ",f,"px;left: ",b,"px;height: ",a,"px;width: ",d,"px;display: block;"].join(""),{duration:Grid.duration,after:function(){if(typeof e=="function"){c.callback(c)}}})},_construct:function(a){this.cfg=a[0]||{};this.top=(this.cfg.top?this.cfg.top:0);this.id=(this.cfg.id?this.cfg.id:"");this.data=(this.cfg.data?this.cfg.data:0);this.rel=(this.cfg.rel?this.cfg.rel:0);this.display=(this.cfg.display?this.cfg.display:"none");this.content=(this.cfg.content?this.cfg.content:{});this.parent=(this.cfg.parent?this.cfg.parent:"");this.state=(this.cfg.state?this.cfg.state:"");this.build();this.setHeight(parseInt($(this.body).height(),10));this.setState(this.state)}});var Initializer=(function(){var a=function(){if(typeof b=="undefined"){var b={log:function(){}}}var c={};if(typeof DomBuilder!=="undefined"){c.create=DomBuilder.create;c.getParent=DomBuilder.getParent;$.fn.extend({addClassName:DomBuilder.addClassName});$.fn.extend({removeClassName:DomBuilder.removeClassName});$.fn.extend({hasClassName:DomBuilder.hasClassName})}if(typeof Stuff!=="undefined"){c.arrayUnique=Stuff.arrayUnique;c.getRndRGB=Stuff.getRndRGB}$.extend(c);if(typeof Grid!=="undefined"){$.fn.extend({grid:Grid.init})}if(typeof Dragger!=="undefined"){$.fn.extend({draggable:Dragger.drag})}};if(typeof $=="undefined"||typeof jQuery=="undefined"){alert("jquery is missing")}else{if(typeof emile=="undefined"){alert("emile is missing")}else{$(document).ready(a)}}})();